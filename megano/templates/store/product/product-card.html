{% load static %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script type="text/javascript" src="{% static 'assets/js/add_to_cart.js' %}"></script>

<div class="ProductCard">
    <div class="ProductCard-look">
        <div class="ProductCard-photo">
            <img src="{{ product.preview.url }}" alt=""/>
        </div>
        <div class="ProductCard-picts">
            <a class="ProductCard-pict ProductCard-pict_ACTIVE" href="{{ product.preview.url }}">
                <img src="{{ product.preview.url }}" alt=""/>
            </a>
            {% for i_img in images %}
                <a class="ProductCard-pict" href="{{ i_img.image.url }}">
                    <img src="{{ i_img.image.url }}" alt=""/>
                </a>
            {% endfor %}
        </div>
    </div>
    <div class="ProductCard-desc">
        <div class="ProductCard-header">
            <h2 class="ProductCard-title">
                {{ product.name }}
            </h2>
            <div class="ProductCard-info">
                <div class="ProductCard-cost">
                    <div class="ProductCard-price">
                        {% if price_avg != None %}
                            <span class="Card-price">${{ price_avg }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="ProductCard-text">
            <ul>
                {% for text in product.description.card_text %}
                    <li>{{ text }}</li>
                {% endfor %}
            </ul>
        </div>
        <form class="add-form-item" action="{% url 'cart:add_product_to_cart' product.offers.first.id %}">
            <div class="ProductCard-cart">
                <div class=" ProductCard-cartElement_amount">
                    <div class="Amount Amount_product">
                        <button class="Amount-remove" type="button">
                        </button>
                        <input class="Amount-input form-input" id="amount" name="amount" type="text" value="1"/>
                        <button class="Amount-add" type="button">
                        </button>
                    </div>
                </div>
                {% if product.offers.all %}
                    <div class="ProductCard-cartElement">
                        <a href="{% url 'cart:add_product_to_cart' product.offers.first.id %}">
                            <button class="btn btn_primary" type="submit" onclick="addProduct()">Купить
                                <img class="btn-icon" src={% static "assets/img/icons/card/cart_white.svg" %}/>
                            </button>
                        </a>
                    </div>
                {% endif %}
                <div id="modal_open" class="my_modal">
                    <div class="my_modal-dialog">
                        <div class="my_modal-content">
                            <div class="my_modal-header">
                                <p class="my_modal-title">Поздравляем!</p>
                                <a href="#" title="Закрыть модальное окно" class="close">×</a>
                            </div>
                            <div class="my_modal-body">
                                <p>Товар успешно добавлен в корзину!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div class="ProductCard-footer">
            <div class="ProductCard-tags">
                {% if product.tags.all %}
                    <strong class="ProductCard-tagsTitle">Тэги:
                    </strong>
                    {% for i_tag in product.tags.all %}
                        {% if not forloop.last %}
                            <a href="#">{{ i_tag }},</a>
                        {% else %}
                            <a href="#">{{ i_tag }}</a>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
</div>
