{% extends 'base/base.html' %}
{% load static %}

{% block content %}
    <div class="Middle Middle_top">
        <div class="Section Section_column Section_columnLeft">
            <div class="wrap">
                <div class="Section-column">
                    {% include 'store/catalog/filter.html' %}
                </div>
                <div class="Section-content">
                    {% include "store/catalog/sorting.html" %}
                    <div class="Cards">
                        {% for product in products %}
                            <div class="Card"><a class="Card-picture"
                                                 href="{% url 'store:product-detail' slug=product.slug %}">
                                <img src="{{ product.preview.url }}"/></a>
                                <div class="Card-content">
                                    <strong class="Card-title">
                                        <a href="{% url 'store:product-detail' slug=product.slug %}">{{ product.name }}</a>
                                    </strong>
                                    <div class="Card-description">
                                        <div class="Card-cost">
                                            {% if product.price != None %}
                                                <span class="Card-price">${{ product.price }}</span>
                                            {% endif %}
                                        </div>
                                        <div class="Card-category">
                                            {% for tag in product.tags.all %}
                                                {% if not forloop.last %}
                                                    {{ tag }}
                                                {% else %}
                                                    {{ tag }}
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        {% if product.offers.all %}
                                            <div class="Card-hover">
                                                {% if product.availability %}
                                                    <a class="Card-btn"
                                                       href="{% url 'cart:add_product_to_cart' product.offers.first.id %}">
                                                        <img src="{% static 'assets/img/icons/card/cart.svg' %}"
                                                             alt="cart.svg"/>
                                                    </a>
                                                {% else %}
                                                    <span class="Card-btn">Нет в наличии</span>
                                                {% endif %}
                                                <a class="Card-btn" href="">
                                                    <form action="{% url 'compare:add_to_comparison' product.id %}"
                                                          method="get">
                                                        <button type="submit">
                                                            <img src="{% static 'assets/img/icons/card/change.svg' %}"
                                                                 alt="change.svg"/>
                                                        </button>
                                                    </form>
                                                </a>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    {% include "store/paginator.html" %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}